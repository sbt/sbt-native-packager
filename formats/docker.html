

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Docker Plugin &mdash; sbt-native-packager 1.11.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b0accced"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Windows Plugin" href="windows.html" />
    <link rel="prev" title="Rpm Plugin" href="rpm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            sbt-native-packager
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#scope">Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#core-concepts">Core Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#format-plugins">Format Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#archetype-plugins">Archetype Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#mappings">Mappings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#architecture">Architecture</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#setup">Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gettingstarted.html#native-tools">Native Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted.html#your-first-package">Your first package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gettingstarted.html#run-the-app">Run the app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gettingstarted.html#create-a-package">Create a package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Formats</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="universal.html">Universal Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="universal.html#related-plugins">Related Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="universal.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="universal.html#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="universal.html#required-settings">Required Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="universal.html#configurations">Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="universal.html#settings">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="universal.html#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="universal.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="universal.html#universal-archive-options">Universal Archive Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="universal.html#getting-started-with-universal-packaging">Getting Started with Universal Packaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="universal.html#universal-conventions">Universal Conventions</a></li>
<li class="toctree-l4"><a class="reference internal" href="universal.html#change-remove-top-level-directory-in-output">Change/Remove Top Level Directory in Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="universal.html#skip-packagedoc-task-on-stage">Skip packageDoc task on stage</a></li>
<li class="toctree-l4"><a class="reference internal" href="universal.html#mappingshelper">MappingsHelper</a></li>
<li class="toctree-l4"><a class="reference internal" href="universal.html#mapping-examples">Mapping Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="linux.html">Linux Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="linux.html#related-plugins">Related Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="linux.html#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="linux.html#required-settings">Required Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="linux.html#configurations">Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="linux.html#settings">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="linux.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="linux.html#package-mappings">Package Mappings</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#the-linuxpackagemapping-models">The LinuxPackageMapping Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#modifying-mappings-in-general">Modifying Mappings in General</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#add-mappings">Add Mappings</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#filter-remove-mappings">Filter/Remove Mappings</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#alter-linuxpackagemapping">Alter LinuxPackageMapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#alter-linuxsymlinks">Alter LinuxSymlinks</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#add-empty-directories">Add Empty Directories</a></li>
<li class="toctree-l4"><a class="reference internal" href="linux.html#man-pages">Man Pages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debian.html">Debian Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="debian.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="debian.html#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="debian.html#required-settings">Required Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="debian.html#jre-dependencies">JRE Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="debian.html#native-packaging">Native packaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="debian.html#java-based-packaging">Java based packaging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="debian.html#configurations">Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="debian.html#settings">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="debian.html#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="debian.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="debian.html#customizing-debian-metadata">Customizing Debian Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="debian.html#hook-actions-into-the-debian-package-lifecycle">Hook Actions into the Debian Package Lifecycle</a></li>
<li class="toctree-l4"><a class="reference internal" href="debian.html#use-a-different-castle-directory-for-your-control-scripts">Use a Different Castle Directory for your Control Scripts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rpm.html">Rpm Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rpm.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="rpm.html#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#required-settings">Required Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#or-higher">1.0 or higher</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#or-lower">0.8 or lower</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rpm.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="rpm.html#settings">Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#informational-settings">Informational Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#dependency-settings">Dependency Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#meta-settings">Meta Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#scriptlet-settings">Scriptlet Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#systemv-start-script-settings">SystemV Start Script Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rpm.html#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="rpm.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#rpm-prefix">Rpm Prefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#rpmchangelogfile">rpmChangelogFile</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#scriptlet-changes">Scriptlet Changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#scriptlet-migration-from-1-0-x">Scriptlet Migration from 1.0.x</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#jar-repackaging">Jar Repackaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="rpm.html#marking-config-files-as-noreplace">Marking config files as <code class="docutils literal notranslate"><span class="pre">noreplace</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Docker Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#required-settings">Required Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spotify-java-based-docker-client">Spotify java based docker client</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#settings">Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#informational-settings">Informational Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment-settings">Environment Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#publishing-settings">Publishing Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#docker-image-name-and-version">Docker Image Name and Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-base-image">Docker Base Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-repository">Docker Repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-image-customization">Docker Image Customization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-location">Install Location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#daemon-user">Daemon User</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-permission">File Permission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#custom-dockerfile">Custom Dockerfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-commands">Remove Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-commands">Add Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#write-from-scratch">Write from Scratch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#busybox-ash-support">Busybox/Ash Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#init-support">Init support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="windows.html">Windows Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="windows.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows.html#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="windows.html#required-settings">Required Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="windows.html#or-higher">1.0 or higher</a></li>
<li class="toctree-l4"><a class="reference internal" href="windows.html#or-lower">0.8 or lower</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="windows.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows.html#settings">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows.html#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="windows.html#feature-configuration">Feature configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jdkpackager.html">JDKPackager Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jdkpackager.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="jdkpackager.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="jdkpackager.html#build">Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="jdkpackager.html#settings">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="jdkpackager.html#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="jdkpackager.html#debugging">Debugging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="graalvm-native-image.html">GraalVM Native Image Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="graalvm-native-image.html#requirements">Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="graalvm-native-image.html#native-image-quick-installation"><code class="docutils literal notranslate"><span class="pre">native-image</span></code> quick installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="graalvm-native-image.html#build">Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="graalvm-native-image.html#required-settings">Required Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="graalvm-native-image.html#settings">Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="graalvm-native-image.html#docker-image-build-settings">Docker Image Build Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="graalvm-native-image.html#publishing-settings">Publishing Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="graalvm-native-image.html#graalvm-resources">GraalVM Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="graalvm-native-image.html#tasks">Tasks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../archetypes/index.html">Archetypes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../archetypes/java_app/index.html">Java Command Line Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_app/index.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_app/index.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_app/index.html#settings-tasks">Settings &amp; Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_app/index.html#start-script-options">Start script options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_app/index.html#multiple-applications">Multiple Applications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_app/index.html#multiple-start-scripts">Multiple start scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_app/index.html#single-start-script-with-forwarders">Single start script with forwarders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_app/index.html#a-note-on-script-names">A note on script names</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_app/index.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_app/customize.html">Application and runtime configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_app/customize.html#start-script-customizations">Start script customizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_app/customize.html#overriding-templates-bash-bat">Overriding Templates (Bash/Bat)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../archetypes/java_server/index.html">Java Server Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_server/index.html#features">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_server/index.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_server/index.html#settings-tasks">Settings &amp; Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_server/index.html#default-mappings">Default Mappings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/java_server/index.html#customize">Customize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_server/customize.html">Application Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_server/customize.html#systemloader-configuration">Systemloader Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_server/customize.html#package-lifecycle-configuration">Package Lifecycle Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/java_server/customize.html#example-configurations">Example Configurations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../archetypes/systemloaders.html">Systemloaders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/systemloaders.html#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/systemloaders.html#general-settings">General Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/systemloaders.html#systemv">SystemV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/systemloaders.html#systemd">Systemd</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/systemloaders.html#settings">Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/systemloaders.html#upstart">Upstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/systemloaders.html#customization">Customization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/systemloaders.html#start-script-location">Start Script Location</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/systemloaders.html#customize-start-script">Customize Start Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/systemloaders.html#override-start-script">Override Start Script</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../archetypes/misc_archetypes.html">Configuration Archetypes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/misc_archetypes.html#ashscript-plugin">AshScript Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/misc_archetypes.html#classpathjar-launcherjar-plugin">ClasspathJar &amp; LauncherJar Plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../archetypes/jlink_plugin.html">Jlink Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/jlink_plugin.html#known-issues">Known issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/jlink_plugin.html#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../archetypes/cheatsheet.html">An archetype cheatsheet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/cheatsheet.html#path-configurations">Path Configurations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#quick-reference-table">Quick Reference Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#settings">Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/cheatsheet.html#jvm-options">JVM Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#extra-defines">Extra Defines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#file-application-ini-or-etc-default">File - application.ini or etc-default</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#setting-javaoptions">Setting - javaOptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../archetypes/cheatsheet.html#overriding-templates">Overriding Templates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#bat-script-src-templates-bat-template">Bat Script - <code class="docutils literal notranslate"><span class="pre">src/templates/bat-template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#bash-script-src-templates-bash-template">Bash Script - <code class="docutils literal notranslate"><span class="pre">src/templates/bash-template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#service-manager-templates">Service Manager Templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../archetypes/cheatsheet.html#server-app-config-src-templates-etc-default-systemv-systemd">Server App Config - <code class="docutils literal notranslate"><span class="pre">src/templates/etc-default-{systemv,systemd}</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../recipes/index.html">Recipes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../recipes/custom.html">Custom Package Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/custom.html#sbt-assembly">SBT Assembly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/custom.html#proguard">Proguard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/custom.html#multi-module-builds">Multi Module Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/custom.html#custom-packaging-format">Custom Packaging Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/longclasspath.html">Dealing with long classpaths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/longclasspath.html#generate-a-launcher-jar">Generate a launcher jar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/longclasspath.html#generate-a-classpath-jar">Generate a classpath jar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/longclasspath.html#configure-a-wildcard-classpath">Configure a wildcard classpath</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/play.html">Play 2 Packaging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/play.html#build-configuration">Build Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/play.html#application-configuration">Application Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../recipes/play.html#systemv">SystemV</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/deployment.html">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/deployment.html#setup-publish-task">Setup publish Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/deployment.html#default-deployment">Default Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/deployment.html#custom-deployments">Custom Deployments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#rpm">RPM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#debian">Debian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#windows">Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/deployment.html#custom-configurations">Custom Configurations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#id1">Debian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#id2">RPM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#id3">Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../recipes/deployment.html#universal">Universal</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/scalajs.html">Scala JS packaging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/scalajs.html#package-webjars-and-scalajs-resources">Package webjars and scalajs resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/package_configuration.html">Build the same package with different configs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/package_configuration.html#sbt-sub-modules">SBT sub modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/package_configuration.html#sbt-parameters-and-build-environment">SBT parameters and Build Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/package_configuration.html#sbt-configuration-scope-not-recommended">SBT configuration scope (not recommended)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/embedded-jvm.html">Embedding JVM in Universal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/embedded-jvm.html#adding-the-jvm">Adding the JVM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/embedded-jvm.html#application-configuration">Application Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../recipes/umask.html">Setting the umask for your process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../recipes/umask.html#within-the-start-script">Within the start script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../recipes/umask.html#system-v-systemd">System V/systemd</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sbt-native-packager</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Packaging Formats</a></li>
      <li class="breadcrumb-item active">Docker Plugin</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/formats/docker.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="docker-plugin">
<span id="id1"></span><h1>Docker Plugin<a class="headerlink" href="#docker-plugin" title="Permalink to this heading">¶</a></h1>
<p>Docker images describe how to set up a container for running an application, including what files are present, and what program to run.</p>
<blockquote>
<div><p><a class="reference external" href="https://docs.docker.com/introduction/understanding-docker/">https://docs.docker.com/introduction/understanding-docker/</a> provides an introduction to Docker.</p>
<p><a class="reference external" href="https://docs.docker.com/reference/builder/">https://docs.docker.com/reference/builder/</a> describes the <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>: a file which describes how to set up the image.</p>
</div></blockquote>
<p>sbt-native-packager focuses on creating a Docker image which can “just run” the application built by SBT.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The docker plugin depends on the <a class="reference internal" href="universal.html#universal-plugin"><span class="std std-ref">Universal Plugin</span></a>.</p>
</div>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">¶</a></h2>
<p>You need the version 1.10 or higher of the docker console client installed.
SBT Native Packager doesn’t use the REST API, but instead uses the CLI directly.</p>
<p>It is <a class="reference external" href="https://github.com/sbt/sbt-native-packager/issues/654">currently not possible</a> to provide authentication
for Docker repositories from within the build. The <code class="docutils literal notranslate"><span class="pre">docker</span></code> binary used by the build should already have been configured
with the appropriate authentication details. See <a class="reference external" href="https://docs.docker.com/engine/reference/commandline/login/">https://docs.docker.com/engine/reference/commandline/login/</a> how to login
to a Docker registry with username and password.</p>
</section>
<section id="build">
<h2>Build<a class="headerlink" href="#build" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbt<span class="w"> </span>Docker/publishLocal
</pre></div>
</div>
<section id="required-settings">
<h3>Required Settings<a class="headerlink" href="#required-settings" title="Permalink to this heading">¶</a></h3>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">enablePlugins</span><span class="p">(</span><span class="nc">DockerPlugin</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spotify-java-based-docker-client">
<h3>Spotify java based docker client<a class="headerlink" href="#spotify-java-based-docker-client" title="Permalink to this heading">¶</a></h3>
<p>You can also use the java-based spotify Docker client. Add this to your <code class="docutils literal notranslate"><span class="pre">build.sbt</span></code></p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">enablePlugins</span><span class="p">(</span><span class="nc">DockerSpotifyClientPlugin</span><span class="p">)</span>
</pre></div>
</div>
<p>and this to your <code class="docutils literal notranslate"><span class="pre">plugins.sbt</span></code></p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">libraryDependencies</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;com.spotify&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;docker-client&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s">&quot;8.9.0&quot;</span>
</pre></div>
</div>
<p>The Docker-spotify client is a provided dependency. You have to explicitly add it on your own. It brings a lot of dependencies
that could slow your build times. This is the reason the dependency is marked as provided.</p>
</section>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
<p>Settings and Tasks inherited from parent plugins can be scoped with <code class="docutils literal notranslate"><span class="pre">Docker</span></code>.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mappings</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mappings</span><span class="p">.</span><span class="n">value</span>
</pre></div>
</div>
</section>
<section id="settings">
<h2>Settings<a class="headerlink" href="#settings" title="Permalink to this heading">¶</a></h2>
<section id="informational-settings">
<h3>Informational Settings<a class="headerlink" href="#informational-settings" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">packageName</span></code></dt><dd><p>The name of the package for Docker (if different from general name).
This will only affect the image name.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">version</span></code></dt><dd><p>The version of the package for Docker (if different from general version).  Often takes the form <code class="docutils literal notranslate"><span class="pre">x.y.z</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">maintainer</span></code></dt><dd><p>The maintainer of the package, recommended by the Dockerfile format.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="environment-settings">
<h3>Environment Settings<a class="headerlink" href="#environment-settings" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dockerBaseImage</span></code></dt><dd><p>The image to use as a base for running the application. It should include binaries on the path for <code class="docutils literal notranslate"><span class="pre">chown</span></code>, <code class="docutils literal notranslate"><span class="pre">mkdir</span></code>, have a discoverable <code class="docutils literal notranslate"><span class="pre">java</span></code> binary, and include the user configured by <code class="docutils literal notranslate"><span class="pre">daemonUser</span></code> (<code class="docutils literal notranslate"><span class="pre">daemon</span></code>, by default).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">daemonUser</span></code></dt><dd><p>The user to use when executing the application. Files below the install path also have their ownership set to this user.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerExposedPorts</span></code></dt><dd><p>A list of TCP ports to expose from the Docker image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerExposedUdpPorts</span></code></dt><dd><p>A list of UDP ports to expose from the Docker image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerExposedVolumes</span></code></dt><dd><p>A list of data volumes to make available in the Docker image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerLabels</span></code></dt><dd><p>A map of labels that will be applied to the Docker image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerEnvVars</span></code></dt><dd><p>A map of environment variables that will be applied to the Docker image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerEntrypoint</span></code></dt><dd><p>Overrides the default entrypoint for docker-specific service discovery tasks before running the application.
Defaults to the bash executable script, available at <code class="docutils literal notranslate"><span class="pre">bin/&lt;script</span> <span class="pre">name&gt;</span></code> in the current <code class="docutils literal notranslate"><span class="pre">WORKDIR</span></code> of <code class="docutils literal notranslate"><span class="pre">/opt/docker</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerPermissionStrategy</span></code></dt><dd><p>The strategy that decides how file permissions are set for the working directory inside the Docker image</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DockerPermissionStrategy.MultiStage</span></code> (default) uses multi-stage Docker build to call chmod ahead of time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerPermissionStrategy.None</span></code> does not attempt to change the file permissions, and use the host machine’s file mode bits.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerPermissionStrategy.Run</span></code> calls <code class="docutils literal notranslate"><span class="pre">RUN</span></code> in the Dockerfile. This has regression on the resulting Docker image file size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerPermissionStrategy.CopyChown</span></code> calls <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">--chown</span></code> in the Dockerfile. Provided as a backward compatibility.</p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerChmodType</span></code></dt><dd><p>The file permissions for the files copied into Docker image when <code class="docutils literal notranslate"><span class="pre">MultiStage</span></code> or <code class="docutils literal notranslate"><span class="pre">Run</span></code> strategy is used.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DockerChmodType.UserGroupReadExecute</span></code> (default): chmod u=rX,g=rX</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerChmodType.UserGroupRead</span></code>: chmod u=r,g=r</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerChmodType.UserGroupWriteExecute</span></code>: chmod u=rwX,g=rwX</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerChmodType.SyncGroupToUser</span></code>: chmod g=u</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerChmodType.UserGroupPlusExecute</span></code>: chmod u+x,g+x (This is for <code class="docutils literal notranslate"><span class="pre">dockerAdditionalPermissions</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DockerChmodType.Custom</span></code>: Custom argument provided by the user.</p></li>
</ul>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerAdditionalPermissions</span></code></dt><dd><p>Additional permissions typically used to give <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code> rights for the executable files. By default generated Bash scripts are given <code class="docutils literal notranslate"><span class="pre">DockerChmodType.UserGroupPlusExecute</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerVersion</span></code></dt><dd><p>The docker server version. Used to leverage new docker features while maintaining backwards compatibility.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerApiVersion</span></code></dt><dd><p>The docker server API version. Used to leverage new docker features while maintaining backwards compatibility.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerGroupLayers</span></code></dt><dd><p>The function mapping files into separate layers to increase docker cache hits.
Lower index means the file would be a part of an earlier layer.
The main idea behind this is to COPY dependencies <a href="#id2"><span class="problematic" id="id3">*</span></a>.jar’s first as they should change rarely.
In separate command COPY the application <a href="#id4"><span class="problematic" id="id5">*</span></a>.jar’s that should change more often.
Defaults to map the project artifacts and its dependencies to separate layers.
To disable layers map all files to no layer using <code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">dockerGroupLayers</span> <span class="pre">:=</span> <span class="pre">PartialFunction.empty</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="publishing-settings">
<h3>Publishing Settings<a class="headerlink" href="#publishing-settings" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dockerRepository</span></code></dt><dd><p>The repository to which the image is pushed when the <code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">publish</span></code> task is run. This should be of the form  <code class="docutils literal notranslate"><span class="pre">[repository.host[:repository.port]]</span></code> (assumes use of the <code class="docutils literal notranslate"><span class="pre">index.docker.io</span></code> repository) or <code class="docutils literal notranslate"><span class="pre">[repository.host[:repository.port]][/username]</span></code> (discouraged, but available for backwards compatibility.).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerUsername</span></code></dt><dd><p>The username or organization to which the image is pushed when the <code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">publish</span></code> task is run. This should be of the form <code class="docutils literal notranslate"><span class="pre">[username]</span></code> or <code class="docutils literal notranslate"><span class="pre">[organization]</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerUpdateLatest</span></code></dt><dd><p>The flag to automatic update the latest tag when the <code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">publish</span></code> task is run. Default value is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.  In order to use this setting, the minimum docker console version required is 1.10. See <a class="reference external" href="https://github.com/sbt/sbt-native-packager/issues/871">https://github.com/sbt/sbt-native-packager/issues/871</a> for a detailed explanation.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerAlias</span></code></dt><dd><p>The alias to be used for tagging the resulting image of the Docker build.
The type of the setting key is <code class="docutils literal notranslate"><span class="pre">DockerAlias</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">[dockerRepository/][dockerUsername/][packageName]:[version]</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerAliases</span></code></dt><dd><p>The list of aliases to be used for tagging the resulting image of the Docker build.
The type of the setting key is <code class="docutils literal notranslate"><span class="pre">Seq[DockerAlias]</span></code>.
Alias values are in format of <code class="docutils literal notranslate"><span class="pre">[dockerRepository/][dockerUsername/][packageName]:[tag]</span></code> where tags are list of including your project version and <code class="docutils literal notranslate"><span class="pre">latest</span></code> tag(if <code class="docutils literal notranslate"><span class="pre">dockerUpdateLatest</span></code> is enabled).
To append additional aliases to this list, you can add them by extending <code class="docutils literal notranslate"><span class="pre">dockerAlias</span></code>.
<code class="docutils literal notranslate"><span class="pre">dockerAliases</span> <span class="pre">++=</span> <span class="pre">Seq(dockerAlias.value.withTag(Option(&quot;stable&quot;)),</span> <span class="pre">dockerAlias.value.withRegistryHost(Option(&quot;registry.internal.yourdomain.com&quot;)))</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerBuildInit</span></code></dt><dd><p>Whether the <code class="docutils literal notranslate"><span class="pre">--init</span></code> build option should be passed to the Docker build. See <span class="xref std std-ref">Init support</span> for when this may be useful.
Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerBuildOptions</span></code></dt><dd><p>Overrides the default Docker build options.
Defaults to <code class="docutils literal notranslate"><span class="pre">Seq(&quot;--force-rm&quot;,</span> <span class="pre">&quot;-t&quot;,</span> <span class="pre">&quot;[dockerAlias]&quot;)</span></code>. This default is expanded if either <code class="docutils literal notranslate"><span class="pre">dockerUpdateLatest</span></code> or <code class="docutils literal notranslate"><span class="pre">dockerBuildInit</span></code> is set to true.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerBuildEnvVars</span></code></dt><dd><p>The environment variables passed to the Docker build.
Defaults to empty.
For example, to disable Docker BuildKit:
<code class="docutils literal notranslate"><span class="pre">dockerBuildEnvVars</span> <span class="pre">+=</span> <span class="pre">&quot;DOCKER_BUILDKIT&quot;</span> <span class="pre">-&gt;</span> <span class="pre">&quot;0&quot;</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerExecCommand</span></code></dt><dd><p>Overrides the default Docker exec command.
Defaults to <code class="docutils literal notranslate"><span class="pre">Seq(&quot;docker&quot;)</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerBuildCommand</span></code></dt><dd><p>Overrides the default Docker build command. The reason for this is that many systems restrict docker execution to root, and while the accepted guidance is to alias the docker command <code class="docutils literal notranslate"><span class="pre">alias</span> <span class="pre">docker='/usr/bin/docker'</span></code>, neither Java nor Scala support passing aliases to sub-processes, and most build systems run builds using a non-login, non-interactive shell, which also have limited support for aliases, which means that the only viable option is to use <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">docker</span></code> directly.
Defaults to <code class="docutils literal notranslate"><span class="pre">Seq(&quot;[dockerExecCommand]&quot;,</span> <span class="pre">&quot;build&quot;,</span> <span class="pre">&quot;[dockerBuildOptions]&quot;,</span> <span class="pre">&quot;.&quot;)</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerRmiCommand</span></code></dt><dd><p>Overrides the default Docker rmi command. This may be used if force flags or other options need to be passed to the command <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">rmi</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">Seq(&quot;[dockerExecCommand]&quot;,</span> <span class="pre">&quot;rmi&quot;)</span></code> and will be directly appended with the image name and tag.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dockerAutoremoveMultiStageIntermediateImages</span></code></dt><dd><p>If intermediate images should be automatically removed when <code class="docutils literal notranslate"><span class="pre">MultiStage</span></code> strategy is used.
Intermediate images usually aren’t needed after packaging is finished and therefore defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.
All intermediate images are labeled <code class="docutils literal notranslate"><span class="pre">snp-multi-stage=intermediate</span></code>.
If set to <code class="docutils literal notranslate"><span class="pre">false</span></code> and you want to remove all intermediate images at a later point, you can therefore do that by filtering for this label:
<code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">image</span> <span class="pre">prune</span> <span class="pre">-f</span> <span class="pre">--filter</span> <span class="pre">label=snp-multi-stage=intermediate</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Permalink to this heading">¶</a></h2>
<p>The Docker plugin provides the following commands:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">stage</span></code></dt><dd><p>Generates a directory with the Dockerfile and environment prepared for creating a Docker image.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">publishLocal</span></code></dt><dd><p>Builds an image using the local Docker server.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">publish</span></code></dt><dd><p>Builds an image using the local Docker server, and pushes it to the configured remote repository.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">clean</span></code></dt><dd><p>Removes the built image from the local Docker server.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="customize">
<h2>Customize<a class="headerlink" href="#customize" title="Permalink to this heading">¶</a></h2>
<p>There are some predefined settings which you can easily customize. These
settings are explained in some detail in the next sections. If you want to
describe your Dockerfile completely yourself, you can provide your own
<cite>docker commands</cite> as described in <a class="reference internal" href="#custom-dockerfile">Custom Dockerfile</a>.</p>
<section id="docker-image-name-and-version">
<h3>Docker Image Name and Version<a class="headerlink" href="#docker-image-name-and-version" title="Permalink to this heading">¶</a></h3>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">packageName</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">packageName</span><span class="p">.</span><span class="n">value</span>

<span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">value</span>
</pre></div>
</div>
</section>
<section id="docker-base-image">
<h3>Docker Base Image<a class="headerlink" href="#docker-base-image" title="Permalink to this heading">¶</a></h3>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dockerBaseImage</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;openjdk&quot;</span>
</pre></div>
</div>
</section>
<section id="docker-repository">
<h3>Docker Repository<a class="headerlink" href="#docker-repository" title="Permalink to this heading">¶</a></h3>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dockerRepository</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">Some</span><span class="p">(</span><span class="s">&quot;dockeruser&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="docker-image-customization">
<h3>Docker Image Customization<a class="headerlink" href="#docker-image-customization" title="Permalink to this heading">¶</a></h3>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dockerExposedPorts</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span><span class="mi">9000</span><span class="p">,</span><span class="w"> </span><span class="mi">9443</span><span class="p">)</span>

<span class="n">dockerExposedVolumes</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span><span class="s">&quot;/opt/docker/logs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to work properly with <cite>USER daemon</cite> the exposed volumes are first
created (if they do not exist) and then chowned.</p>
</section>
<section id="install-location">
<h3>Install Location<a class="headerlink" href="#install-location" title="Permalink to this heading">¶</a></h3>
<p>The path to which the application is written can be changed with the location setting.
The files from <code class="docutils literal notranslate"><span class="pre">Docker</span> <span class="pre">/</span> <span class="pre">mappings</span></code> are extracted underneath this directory.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">defaultLinuxInstallLocation</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;/opt/docker&quot;</span>
</pre></div>
</div>
</section>
<section id="daemon-user">
<h3>Daemon User<a class="headerlink" href="#daemon-user" title="Permalink to this heading">¶</a></h3>
<p>By default, sbt Native Packager will create a daemon user named <code class="docutils literal notranslate"><span class="pre">demiourgos728</span></code>
whose UID is set to <code class="docutils literal notranslate"><span class="pre">1001</span></code>, and emit <code class="docutils literal notranslate"><span class="pre">USER</span> <span class="pre">1001</span></code> since running as non-root is considered the best practice.</p>
<p>The following can be used to emit <code class="docutils literal notranslate"><span class="pre">USER</span> <span class="pre">daemon</span></code> instead:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">daemonUserUid</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">None</span>
<span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">daemonUser</span><span class="w">    </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;daemon&quot;</span>
</pre></div>
</div>
</section>
<section id="file-permission">
<h3>File Permission<a class="headerlink" href="#file-permission" title="Permalink to this heading">¶</a></h3>
<p>By default, the working directory inside the Docker image is given read-only file permissions
set using multi-stage Docker build, which requires Docker 17.5 or later (watch out if you’re using older Minikube).</p>
<p>If you want to make the working directory writable by the running process, here’s the setting:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">typesafe</span><span class="p">.</span><span class="nn">sbt</span><span class="p">.</span><span class="nn">packager</span><span class="p">.</span><span class="nn">docker</span><span class="p">.</span><span class="nc">DockerChmodType</span>

<span class="n">dockerChmodType</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">DockerChmodType</span><span class="p">.</span><span class="nc">UserGroupWriteExecute</span>
</pre></div>
</div>
<p>By default, the shell scripts generated by SBT Native Packager are given <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code> rights. Here’s the setting to do so for other files:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">typesafe</span><span class="p">.</span><span class="nn">sbt</span><span class="p">.</span><span class="nn">packager</span><span class="p">.</span><span class="nn">docker</span><span class="p">.</span><span class="nc">DockerChmodType</span>

<span class="n">dockerAdditionalPermissions</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="nc">DockerChmodType</span><span class="p">.</span><span class="nc">UserGroupPlusExecute</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/opt/docker/bin/hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you don’t want SBT Native Packager to change the file permissions at all here’s a strategy you can choose:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">typesafe</span><span class="p">.</span><span class="nn">sbt</span><span class="p">.</span><span class="nn">packager</span><span class="p">.</span><span class="nn">docker</span><span class="p">.</span><span class="nc">DockerPermissionStrategy</span>

<span class="n">dockerPermissionStrategy</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">DockerPermissionStrategy</span><span class="p">.</span><span class="nc">None</span>
</pre></div>
</div>
<p>This will inherit the file mode bits set in your machine. Given that Kubernetes implementations like OpenShift will use an arbitrary user,
remember to set both the user bits and group bits when running <code class="docutils literal notranslate"><span class="pre">chmod</span></code> yourself.</p>
</section>
<section id="custom-dockerfile">
<h3>Custom Dockerfile<a class="headerlink" href="#custom-dockerfile" title="Permalink to this heading">¶</a></h3>
<p>All settings before are used to create a single sequence of docker commands.
You have the option to write all of them on your own, filter or change existing
commands or simply add some.</p>
<p>First of all you should take a look what you docker commands look like.
In your sbt console type</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>show<span class="w"> </span>dockerCommands
<span class="o">[</span>info<span class="o">]</span><span class="w"> </span>List<span class="o">(</span>Cmd<span class="o">(</span>FROM,openjdk:8<span class="o">)</span>,<span class="w"> </span>Cmd<span class="o">(</span>LABEL,MAINTAINER<span class="o">=</span>Your<span class="w"> </span>Name<span class="w"> </span>&lt;y.n@yourcompany.com&gt;<span class="o">)</span>,<span class="w"> </span>...<span class="o">)</span>
</pre></div>
</div>
</section>
<section id="remove-commands">
<h3>Remove Commands<a class="headerlink" href="#remove-commands" title="Permalink to this heading">¶</a></h3>
<p>SBT Native Packager adds commands you may not need. For example,
the chowning of a exposed volume:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">typesafe</span><span class="p">.</span><span class="nn">sbt</span><span class="p">.</span><span class="nn">packager</span><span class="p">.</span><span class="nn">docker</span><span class="p">.</span><span class="n">_</span>

<span class="c1">// we want to filter the chown command for &#39;/data&#39;</span>
<span class="n">dockerExposedVolumes</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;/data&quot;</span>

<span class="c1">// use filterNot to return all items that do NOT meet the criteria</span>
<span class="n">dockerCommands</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">dockerCommands</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">filterNot</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="c1">// ExecCmd is a case class, and args is a varargs variable, so you need to bind it with @</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="nc">ExecCmd</span><span class="p">(</span><span class="s">&quot;RUN&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">_*</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&quot;chown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&quot;/data&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="c1">// don&#39;t filter the rest; don&#39;t filter out anything that doesn&#39;t match a pattern</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">cmd</span><span class="w">                       </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="add-commands">
<h3>Add Commands<a class="headerlink" href="#add-commands" title="Permalink to this heading">¶</a></h3>
<p>Since <code class="docutils literal notranslate"><span class="pre">dockerCommands</span></code> is just a <code class="docutils literal notranslate"><span class="pre">Sequence</span></code>, adding commands is straightforward:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">typesafe</span><span class="p">.</span><span class="nn">sbt</span><span class="p">.</span><span class="nn">packager</span><span class="p">.</span><span class="nn">docker</span><span class="p">.</span><span class="n">_</span>

<span class="c1">// use += to add an item to a Sequence</span>
<span class="n">dockerCommands</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nc">Cmd</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">daemonUser</span><span class="p">).</span><span class="n">value</span><span class="p">)</span>

<span class="c1">// use ++= to merge a sequence with an existing sequence</span>
<span class="n">dockerCommands</span><span class="w"> </span><span class="o">++=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">  </span><span class="c1">// setting the run script executable</span>
<span class="w">  </span><span class="nc">ExecCmd</span><span class="p">(</span><span class="s">&quot;RUN&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;chmod&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;u+x&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="s">s&quot;</span><span class="si">${</span><span class="p">(</span><span class="nc">Docker</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">defaultLinuxInstallLocation</span><span class="p">).</span><span class="n">value</span><span class="si">}</span><span class="s">/bin/</span><span class="si">${</span><span class="n">executableScriptName</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s">&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="c1">// setting a daemon user</span>
<span class="w">  </span><span class="nc">Cmd</span><span class="p">(</span><span class="s">&quot;USER&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;daemon&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="write-from-scratch">
<h3>Write from Scratch<a class="headerlink" href="#write-from-scratch" title="Permalink to this heading">¶</a></h3>
<p>You can simply wipe out all docker commands with</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dockerCommands</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">()</span>
</pre></div>
</div>
<p>Now let’s start adding some Docker commands.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">typesafe</span><span class="p">.</span><span class="nn">sbt</span><span class="p">.</span><span class="nn">packager</span><span class="p">.</span><span class="nn">docker</span><span class="p">.</span><span class="n">_</span>

<span class="n">dockerCommands</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nc">Seq</span><span class="p">(</span>
<span class="w">  </span><span class="nc">Cmd</span><span class="p">(</span><span class="s">&quot;FROM&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;openjdk:8&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nc">Cmd</span><span class="p">(</span><span class="s">&quot;LABEL&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">s&quot;&quot;&quot;MAINTAINER=&quot;</span><span class="si">${</span><span class="n">maintainer</span><span class="p">.</span><span class="n">value</span><span class="si">}</span><span class="s">&quot;&quot;&quot;&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nc">ExecCmd</span><span class="p">(</span><span class="s">&quot;CMD&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;echo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hello, World from Docker&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="busybox-ash-support">
<h3>Busybox/Ash Support<a class="headerlink" href="#busybox-ash-support" title="Permalink to this heading">¶</a></h3>
<p>Busybox is a popular minimal Docker base image that uses <a class="reference external" href="https://en.wikipedia.org/wiki/Almquist_shell">ash</a>, a much
more limited shell than bash.  By default, the Java archetype (<a class="reference internal" href="../archetypes/java_app/index.html#java-app-plugin"><span class="std std-ref">Java Application Archetype</span></a>) generates two files for shell
support: a <code class="docutils literal notranslate"><span class="pre">bash</span></code> file, and a Windows <code class="docutils literal notranslate"><span class="pre">.bat</span></code> file.  If you build a Docker image for Busybox using the defaults, the
generated bash launch script will likely not work.</p>
<p>To handle this, you can use <em>AshScriptPlugin</em>, an ash-compatible archetype that is derived from the <a class="reference internal" href="../archetypes/java_app/index.html#java-app-plugin"><span class="std std-ref">Java Application Archetype</span></a> archetype.
.  Enable this by including:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">enablePlugins</span><span class="p">(</span><span class="nc">AshScriptPlugin</span><span class="p">)</span>
</pre></div>
</div>
<p>With this plugin enabled an ash-compatible launch script will be generated in your Docker image.</p>
<p>Just like for <a class="reference internal" href="../archetypes/java_app/index.html#java-app-plugin"><span class="std std-ref">Java Application Archetype</span></a>, you have the option of overriding the default script by supplying
your own <code class="docutils literal notranslate"><span class="pre">src/templates/ash-template</span></code> file.  When overriding the file don’t forget to include
<code class="docutils literal notranslate"><span class="pre">${{template_declares}}</span></code> somewhere to populate <code class="docutils literal notranslate"><span class="pre">$app_classpath</span> <span class="pre">$app_mainclass</span></code> from your sbt project.
You’ll likely need these to launch your program.</p>
</section>
<section id="init-support">
<h3>Init support<a class="headerlink" href="#init-support" title="Permalink to this heading">¶</a></h3>
<p>By default, Java will run with PID 1 when you run your docker container. The JVM behaves differently when its PID is 1
compared to other PIDs, most notably, it doesn’t respond to some signals. These include the signals usually used to
instruct a Java process to dump its threads or its heap. If you want to be able to debug a running Java container, the
inability to take thread or heap dumps can be a problem.</p>
<p>Docker has a convenient solution to this, it can configure a separate init process for you. This process will start
your Java process, and it will also do some other useful things that init processes are meant to do like cleaning up
orphaned processes in the container. But most importantly it will ensure that your Java process is not PID 1, which
will in turn ensure that your Java process is able to respond to signals for debugging. The command docker uses is
<a class="reference external" href="https://github.com/krallin/tini">tini</a>, which as its name suggests, is tiny, only 23kb in size.</p>
<p>To tell docker to configure a separate init process using tini, set the <cite>dockerBuildInit</cite> setting to <cite>true</cite>:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dockerBuildInit</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">true</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rpm.html" class="btn btn-neutral float-left" title="Rpm Plugin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="windows.html" class="btn btn-neutral float-right" title="Windows Plugin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014 sbt-native-packager team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>